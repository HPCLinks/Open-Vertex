." Text automatically generated by txt2man-1.4.7
.TH statfs 4  "November 30, 2006" "" ""
.SH NAME
\fBstatfs \fP- gather information about computers running xcpufs
.SH SYNOPSIS
.nf
.fam C
\fBstatfs\fP [\fB-dhn\fP] [\fB-D\fP \fIdebugmask\fP] [\fB-p\fP \fIport\fP] [\fB-c\fP \fIconf\fP] [\fB-w\fP \fIworkers\fP]
.fam T
.fi
.SH DESCRIPTION
\fBstatfs\fP is a 9P file server which provides status information about a set
of computers running \fBxcpufs\fP(4). The file system of \fBstatfs\fP currently
contains a single file named "state" which lists all nodes that have
been described in its configuration file, their IP addresses, the
architecture of the remote computer and the status as reported by
\fBxcpufs\fP(4).
.PP
\fBstatfs\fP operates as a daemon by detaching from the console and logging information about 
.SH OPTIONS
.TP
.B
\fB-h\fP
Display help information
.TP
.B
\fB-d\fP
Turn on 9P debugging messages
.TP
.B
\fB-n\fP
Do not detach from the console (useful when debugging)
.TP
.B
\fB-D\fP mask
Debug a particular subsystem of the \fBstatfs\fP code useful in
combination with \fB-n\fP. The mask argument is a bitmask. There
is no restriction on how many of the bits can be set. Valid masks are:
.RS
.PP
1 - print function calls
2 - 9P filesystem handling 
4 - parsing of the configure file
8 - thread creation and locking
16 - loops within threads
32 - reads from clients
64 - writes from clients (currently unused)
.RE
.TP
.B
\fB-p\fP \fIport\fP
Listen on "\fIport\fP" instead of the default 20002
.TP
.B
\fB-c\fP \fIconf\fP
Read configuration file "\fIconf\fP" instead of the default
"/etc/clustermatic/statfs.conf"
.TP
.B
\fB-w\fP \fIworkers\fP
Number of worker threads started to handle client requests
(default 16)
.SH CONFIGURATION
Statfs uses a configuration file to figure out which nodes it should
connect to. The configuration file can be specified at startup (a
default file name "/etc/clustermatic/statfs.conf" is conveniently
assumed if no "\fB-c\fP" is given). The format of the config file is:
.PP
.nf
.fam C
                nodename=address

.fam T
.fi
Where "nodename" is a shorthand name of the remote machine at address.
The format of address is the default \fBxcpu\fP(4) format, namely
"[tcp!]<hostname|ip address>[!\fIport\fP]".
.PP
An example configuration file is provided in the \fBstatfs\fP source
directory, and printed here for reference:
.PP
.nf
.fam C
                x1=tcp!10.0.0.1!2000
                x2=tcp!10.0.0.2!2001
                x3=tcp!10.0.0.3!2002
                x4=tcp!10.0.0.4!2003

.fam T
.fi
.SH EXAMPLE
This command will start \fBstatfs\fP in a non-daemon mode, with debugging of function calls and
client writes, and a configure file from the home directory:
.PP
.nf
.fam C
                $ statfs -n -D 33 -c ~/statfs.conf

.fam T
.fi
.SH SEE ALSO
\fBxstat\fP(4), \fBxcpufs\fP(4), \fBxcpu\fP(4)
.SH BUGS
Statfs uses the multithreaded version of the 9P server library, npfs.
This library is not exercised as thoroughly as its single-threaded
cousin, \fBspfs\fP(3). A design for a single-threaded \fBstatfs\fP is still far
from clear.
